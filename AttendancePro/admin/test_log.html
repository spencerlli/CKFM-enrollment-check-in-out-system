<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Log</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <link rel="stylesheet" href="../sdk/sdk.css" />
    <link rel="stylesheet" href="../sdk/helper.css" />
    <link rel="stylesheet" href="../sdk/iconfont.css" />
    <style>
      html,
      body,
      .app-wrapper {
        position: relative;
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>
    <div id="root" class="app-wrapper"></div>
    <script src=" ../sdk/sdk.js"></script>
    <script type="text/javascript">
      (function () {
        let amis = amisRequire('amis/embed');
        let amisJSON = {
          "type": "page",
          // "data": {
          //   "items": [
          //     {
          //       "id": "1",
          //       "student_name": "Post Malone",  // student's first + last name
          //       "current_status": "2",          // 0 = not checked in; 
          //                                       // 1 = checked in but not checked out;
          //                                       // 2 = checked out;
          //       "check_in_method": "barcode",
          //       "check_in": "Father Malone",    // guardian's first + last name
          //       "check_in_time": "1661882133",  // Unix Timestamp
          //       "check_out": "Father Malone",   // guardian's first + last name
          //       "check_out_time": "1661903733", // Unix Timestamp
          //       "programs": ["sunday_school", "cm_lounge"]  // list of programs
          //     },
          //     {
          //       "id": "2",
          //       "student_name": "John Smith",
          //       "current_status": "1",
          //       "check_in_method": "barcode",
          //       "check_in": "Bob Smith",
          //       "check_in_time": "1661537553",
          //       "programs": ["kid_choir", "u3_friday"]
          //     },
          //     {
          //       "id": "3",
          //       "student_name": "Alex Smell",
          //       "current_status": "0",
          //       "check_in_method": "barcode",
          //       "programs": ["friday_lounge", "friday_night"]
          //     }
          //   ]
          // },
          "body": {
            "type": "crud",
            "api": "http://54.245.168.231:5002/attendanceReport",
            "syncLocation": false,
            "filter": {
              "debug": false,
              "body": [
                {
                  "type": "input-text",
                  "name": "student_name",
                  "label": "Student name:"
                },
                {
                  "type": "select",
                  "name": "current_status",
                  "label": "Current status:",
                  "options": [
                    {
                      "label": "Not checked in",
                      "value": "0"
                    },
                    {
                      "label": "Checked in",
                      "value": "1"
                    },
                    {
                      "label": "Checked out",
                      "value": "2"
                    }
                  ]
                },
                {
                  "type": "select",
                  "name": "check_in_method",
                  "label": "Check-in/out method:",
                  "options": [
                    {
                      "label": "Barcode",
                      "value": "barcode"
                    }
                  ]
                },
                {
                  "type": "input-text",
                  "name": "check_in",
                  "label": "Checked in by:"
                },
                {
                  "type": "input-datetime-range",
                  "name": "check_in_time",
                  "label": "Checked in time range:"
                },
                {
                  "type": "input-text",
                  "name": "check_out",
                  "label": "Checked out by:"
                },
                {
                  "type": "input-datetime-range",
                  "name": "check_out_time",
                  "label": "Checked out time range:"
                },
                {
                  "type": "select",
                  "name": "programs",
                  "label": "Program(s):",
                  "multiple": true,
                  "options": [
                    {
                      "label": "Sunday School",
                      "value": "sunday_school"
                    },
                    {
                      "label": "CM Parent and Child Lounge",
                      "value": "cm_lounge"
                    },
                    {
                      "label": "Canaan Kid's Choir/Art",
                      "value": "kid_choir"
                    },
                    {
                      "label": "U3 Friday Night",
                      "value": "u3_friday"
                    },
                    {
                      "label": "Friday Night CKFM and Chlid Lounge",
                      "value": "friday_lounge"
                    },
                    {
                      "label": "Friday Night",
                      "value": "friday_night"
                    }
                  ]
                }
              ],
              "actions": [
                {
                  "type": "reset",
                  "label": "Reset"
                },
                {
                  "type": "button",
                  "label": "Get achievement report",
                  "actionType": "ajax",
                  "required": ["student_name", "check_out_time", "programs"],
                  "api": {
                    "method": "get",
                    "url": "test",
                    "responseType": "blob",
                    "data": {
                      "&": "$$",
                      "achievement_report": true
                    }
                  }
                },
                {
                  "type": "button",
                  "label": "Get attendance rate",
                  "actionType": "ajax",
                  "required": ["check_out_time", "programs"],
                  "api": {
                    "method": "get",
                    "url": "test",
                    "responseType": "blob",
                    "data": {
                      "&": "$$",
                      "attendance_rate": true
                    }
                  }
                },
                {
                  "type": "button",
                  "label": "Get attendance report",
                  "actionType": "ajax",
                  "required": ["programs"],
                  "api": {
                    "method": "get",
                    "url": "test",
                    "responseType": "blob",
                    "data": {
                      "&": "$$",
                      "attendance_report": true
                    }
                  }
                },
                {
                  "type": "submit",
                  "level": "primary",
                  "label": "Search"
                }
              ]
            },
            "columns": [
              {
                "name": "id",
                "label": "ID"
              },
              {
                "name": "student_name",
                "label": "Student Name"
              },
              {
                "name": "current_status",
                "type": "mapping",
                "label": "Current Status",
                "map": {
                  "0": "<span class='label label-warning'>Not checked in</span>",
                  "1": "<span class='label label-info'>Checked in</span>",
                  "2": "<span class='label label-success'>Checked out</span>",
                  "*":  "<span class='label label-default'>Other</span>"
                }
              },
              {
                "name": "check_in_method",
                "label": "Check-in/out Method"
              },
              {
                "name": "check_in",
                "label": "Checked in by"
              },
              {
                "type": "date",
                "name": "check_in_time",
                "label": "Check-in Time",
                "format": "HH:mm, MM/DD"
              },
              {
                "name": "check_out",
                "label": "Checked out by"
              },
              {
                "type": "date",
                "name": "check_out_time",
                "label": "Check-out Time",
                "format": "HH:mm, MM/DD"
              },
              {
                "name": "programs",
                "type": "mapping",
                "label": "Program(s)",
                "map": {
                  "sunday_school": "<span class='label label-default'>Sunday School</span>",
                  "cm_lounge": "<span class='label label-default'>CM Parent and Child Lounge</span>",
                  "kid_choir": "<span class='label label-default'>Canaan Kid's Choir/Art</span>",
                  "u3_friday": "<span class='label label-default'>U3 Friday Night</span>",
                  "friday_lounge": "<span class='label label-default'>Friday Night CKFM and Chlid Lounge</span>",
                  "friday_night": "<span class='label label-default'>Friday Night</span>",
                }
              },
              {
                "type": "operation",
                "label": "Daily Progress",
                "buttons": [
                  {
                    "type": "button",
                    "label": "Enter",
                    "level": "link",
                    "actionType": "dialog",
                    "dialog": {
                      "title": "Enter daily progress",
                      "body": {
                        "type": "form",
                        "api": "post:api${id}",
                        "body": [
                          {
                            "type": "checkboxes",
                            "name": "daily_progress",
                            "label": "Checklist",
                            "options": [
                              {
                                "label": "Being on time",
                                "value": "on_time"
                              },
                              {
                                "label": "Bring a friend",
                                "value": "bring_friend"
                              }
                            ]
                          }
                        ]
                      }
                    }
                  }
                ]
              }
            ]
          }
        };
        let amisScoped = amis.embed('#root', amisJSON, {locale: 'en-US'});
      })();
    </script>
  </body>
</html>